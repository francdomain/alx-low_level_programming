This is a low level programming on more functions, more nested loop
